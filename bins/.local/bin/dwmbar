#!/usr/bin/env sh

# Handle SIGTRAP signals sent by refbar to update the status bar immediately.
# trap 'update' 5

# Set the deliminter character.
delim=" "  #  

status() { \
    
    echo " "
    $HOME/.local/bin/status/music       && echo "$delim"
    $HOME/.local/bin/status/memory      && echo "$delim"
    $HOME/.local/bin/status/disk        && echo "$delim"
    $HOME/.local/bin/status/mail        && echo "$delim"
    $HOME/.local/bin/status/internet    && echo "$delim"
    $HOME/.local/bin/status/battery     && echo "$delim"
    $HOME/.local/bin/status/moonphase
    $HOME/.local/bin/status/date    

}

update() { \
	# piping into tr to get rid of all the new line characters introduced by echos
    xsetroot -name "$(status | tr -d '\n')"
    # echo "$(status | tr -d '\n')" &
    # wait
}

while :; do
    update
	# Sleep for a minute after changing the status bar before updating it
	# again. We run sleep in the background and use wait until it finishes,
   	# because traps can interrupt wait immediately, but they can't do that
   	# with sleep.
	sleep 1 &
    wait
done
