#!/bin/sh
# Shows the current phase of the moon.

moonfile="${XDG_DATA_HOME:-$HOME/.local/share}/moonphase"

[ -f "$moonfile" ] && [ "$(stat -c %y "$moonfile" 2>/dev/null | cut -d' ' -f1)" = "$(date '+%Y-%m-%d')" ] && icon="$(cat "$moonfile")" && echo "${icon-?}" && exit 0

moonday=$(curl -sf "wttr.in/?format=%M") || exit

icons=( \
   "îŽ" "îŽŽ" "îŽ" "îŽ" "îŽ‘" "îŽ’" "îŽ“" "îŽ”" "îŽ•" "îŽ–" "îŽ—" "îŽ—" "îŽ™" "îŽš" "îŽ›" \ 
   "îŽœ" "îŽ" "îŽž" "îŽŸ" "îŽ " "îŽ¡" "îŽ¢" "îŽ£" "îŽ¤" "îŽ¥" "îŽ¦" "îŽ§" "îŽ¨"  \
)

icon="${icons[$moonday]}"
echo "${icon-?}" > "$moonfile"
echo "${icon-?}" 
purnima=( 15 0 11 26 )
[[ ${purnima[@]} =~ (^|[[:space:]])"$moonday"($|[[:space:]])  ]] &&  echo ðŸ›• && echo ðŸ›• >> "$moonfile" 
